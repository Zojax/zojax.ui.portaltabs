<tal:block condition="context/has_folders">
<div class="z-portlet" i18n:domain="zojax.ui.portaltabs" tal:define="folders context/folders">
    <h2 class="z-portlet-header" tal:content="python:context.label is None and context.title or context.label">Title</h2>
    <div class="z-portlet-body">
        <div class="z-portlet-item">
            <ul class="tree-node">
                <li tal:repeat="folder folders">
                    <span tal:condition="folder/itemsCount" tal:attributes="class python:folder['isOpen'] and 'control opened' or 'control closed'"></span>
                    <span tal:condition="python:not folder.itemsCount" class="control"></span>
                    <tal:block tal:content="structure folder/folder/@@zmi_icon"></tal:block>
                    <span tal:attributes="class python:folder['current'] and 'current' or ''">
                        <a tal:attributes="href folder/url" tal:content="folder/title"/>
                        <span tal:condition="folder/itemsCount" tal:content="string:(${folder/itemsCount})"></span>
                    </span>
                    <metal:block use-macro="view/template/macros/subfolder" />
                </li>
            </ul>
        </div>
    </div>
</div>
</tal:block>

<tal:block condition="nothing">
<metal:block define-macro="subfolder">
  <ul tal:attributes="class python:folder['isOpen'] and 'tree-node open' or 'tree-node closed'">
    <li tal:repeat="folder folder/subfolders" class="tree-node">
        <span tal:condition="folder/itemsCount" tal:attributes="class python:folder['isOpen'] and 'control opened' or 'control closed'"></span>
        <span tal:condition="python:not folder.itemsCount" class="control"></span>
        <tal:block tal:content="structure folder/folder/@@zmi_icon"></tal:block>
        <span tal:attributes="class python:folder['current'] and 'current' or ''">
            <a tal:attributes="href folder/url" tal:content="folder/title"/>
            <span tal:condition="folder/itemsCount" tal:content="string:(${folder/itemsCount})"></span>
        </span>
        <metal:block use-macro="view/template/macros/subfolder" />
    </li>
    <li tal:repeat="item folder/items" class="tree-node">
        <span class="elbow"></span>
        <tal:block tal:content="structure item/item/@@zmi_icon"></tal:block>
        <span>
            <a tal:attributes="href item/url" tal:content="item/title"></a>
        </span>
    </li>
  </ul>
  <div class="visualClear"></div>
</metal:block>
</tal:block>

